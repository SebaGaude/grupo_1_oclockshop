<!DOCTYPE html>
<html lang="en">

<%- include("partials/head") %>

    <body>

        <%- include("partials/header.ejs") %>

            <main class="main_edit">

                <!-- Formulario de edicion del producto-->



                <form action="/products/<%= product.id %>?_method=PUT" method="POST"
                    class="formulario-edicion-creacion" enctype="multipart/form-data">


                    <h1 class="titulo-new-edit">
                        Edicion de producto: <%= product.articulo %>
                    </h1>

                    <ul id="errorsEdit"></ul>

                    <div class="control-formulario">
                        <label class="preguntas-form"> Nombre del artículo </label>
                        <input type="text" id="articulo" name="articulo" value="<%= product.articulo %>" class="ticks">
                        <% if (locals.errors && errors.articulo) { %>
                            <div class="errorMsg">
                                <%= errors.articulo.msg %> 
                            </div>
                        <% } %>
                   
                    </div>

                    <div class="control-formulario">
                        <label class="preguntas-form"> Ingrese una nueva descripcion del artículo si desea
                            modificarla</label>
                        <input type="textarea" id="descripcion" name="descripcion" value="<%= product.descripcion%>" class="ticks">
                        <% if (locals.errors && errors.descripcion) { %>
                            <div class="errorMsg">
                                <%= errors.descripcion.msg %>
                            </div>
                        <% } %>
                    
                    </div>

                    <div class="control-formulario">
                        <label class="preguntas-form"> Nueva/s imagen/es del producto </label>
                        <input type="file" id="imagenProducto" name="imagen" accept=".jpg, .png" multiple>
                        <% if (locals.errors && errors.imagen) { %>
                            <div class="errorMsg">
                                <%= errors.imagen.msg %> 
                            </div>
                        <% } %>
                    </div>


                    <div class="control-formulario">
                        <label class="preguntas-form"> Ingrese la nueva categoria si desea modificarla</label>
                        <select id="categoria" name="categoria" class="ticks">
                            <option disabled selected value> -- Elegir una opción -- </option>
                            <% for (let i=0; i<categorias.length; i++)  {%>
                      
                                <% if (categorias[i].id == product.id_categoria){ %>

                                    <option value="<%=categorias[i].id %>" selected>
                                     <%=categorias[i].nombre%>
                                 </option>

                                <% }   else {%>
                                    <option value="<%=categorias[i].id %>">
                                     <%=categorias[i].nombre%>
                                 </option>

                                    <% }  %>
                                
                                 <%} %>
                       </select>         
                    
                    </div>
                    <div class="control-formulario">
                        <label class="preguntas-form"> Ingrese nueva cantidad en stock si asi lo desea</label>
                        <input type="number" id="numero" name="stock" placeholder="cantidad..." value="<%= product.stock%>" class="ticks">
                    </div>
                    <div class="control-formulario">
                        <label class="preguntas-form"> Ingrese nueva marca del articulo si desea
                            modificarlo</label>
                            <select id="marca" name="marca" class="ticks">
                                <option disabled selected value> -- Elegir una opción -- </option>
                                <% for (let i=0; i<marcas.length; i++)  {%>
                          
                                    <% if (marcas[i].id == product.id_marca){ %>

                                        <option value="<%=marcas[i].id %>" selected>
                                         <%=marcas[i].nombre%>
                                     </option>

                                    <% }   else {%>
                                        <option value="<%=marcas[i].id %>">
                                         <%=marcas[i].nombre%>
                                     </option>

                                        <% }  %>
                                    
                                     <%} %>
                           </select>         
                    </div>
                    <div class="control-formulario">
                        <label class="preguntas-form">Ingrese el nuevo precio del articulo si desea modificarla</label>
                        <input type="text" id="precio" name="precio" value="<%= product.precio %>" class="ticks">
                    </div>

                    <!-- Botones de edit y delete-->
                    <div>

                        <button type="submit" class="boton-envio">Guardar cambios</button>
                    </div>
                    <!-- ----------- -->
                    
                </form>
                
                <form method="POST" action="/products/delete/<%= product.id%>?_method=DELETE">
                    <button type="submit" class="boton-reset">Borrar articulo</button>
                </form>
            </main>
            <script src="../../js/validator.js"></script>
            <%- include("partials/footer.ejs") %>

</html>